<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Eco-Farm Manager - Crop Recommendations</title>
	<link rel="stylesheet" href="dashboard.css">
	<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
</head>
<body>
	<div class="dashboard-container">
		<aside class="sidebar">
			<div class="logo">
				<h2><i class="fas fa-leaf"></i> Eco-Farm</h2>
			</div>
			<nav class="menu">
				<ul>
					<li><a href="dashboard.html"><i class="fas fa-home"></i> Dashboard</a></li>
					<li class="active"><a href="croprecommendations.html"><i class="fas fa-seedling"></i> Crop Recommendations</a></li>
					<li><a href="fertilizeradvice.html"><i class="fas fa-flask"></i> Fertilizer Advice</a></li>
					<li><a href="yieldrecords.html"><i class="fas fa-chart-line"></i> Yield Records</a></li>
					<li><a href="cropcalendar.html"><i class="fas fa-calendar-alt"></i> Crop Calendar</a></li>
					<li><a href="chatbot.html"><i class="fas fa-robot"></i> Chatbot</a></li>
					<li><a href="knowledgebase.html"><i class="fas fa-book"></i> Knowledge Base</a></li>
					<li><a href="faq.html"><i class="fas fa-question-circle"></i> FAQs</a></li>
					<li><a href="alerts.html"><i class="fas fa-bell"></i> Alerts</a></li>
					<li><a href="settings.html"><i class="fas fa-cog"></i> Settings</a></li>
					<li><a href="#" id="logout"><i class="fas fa-sign-out-alt"></i> Logout</a></li>
				</ul>
			</nav>
		</aside>

		<main class="main-content">
			<header class="top-bar">
				<div class="user-info">
					<img src="https://ui-avatars.com/api/?name=Farmer+User&background=4caf50&color=fff" alt="User">
					<span>Welcome, Farmer!</span>
				</div>
			</header>
							

			<div class="content">
				<div class="welcome-banner">
					<h1>Crop Recommendations</h1>
					<p>Get the best crop suggestions based on your soil and climate conditions.</p>
				</div>

				<div class="content-grid">
					<div class="card crop-form-card">
						<h2><i class="fas fa-seedling"></i> Find Suitable Crops</h2>
						<form id="cropForm">
							<div class="form-group">
								<label for="soilType">Soil Type:</label>
								<select id="soilType">
									<option value="clay">Clay</option>
									<option value="sandy">Sandy</option>
									<option value="loamy">Loamy</option>
									<option value="silty">Silty</option>
									<option value="peaty">Peaty</option>
									<option value="chalky">Chalky</option>
									<option value="saline">Saline</option>
									<option value="red">Red</option>
									<option value="black">Black</option>
								</select>
							</div>
							<div class="form-group">
								<label for="temperature">Temperature (Â°C):</label>
								<input type="number" id="temperature" value="28">
							</div>
							<div class="form-group">
								<label for="rainfall">Rainfall (mm):</label>
								<input type="number" id="rainfall" value="120">
							</div>
							<button type="submit" class="btn btn-primary">Get Recommendations</button>
						</form>
					</div>

					<div class="card recommendations-card">
						<h2><i class="fas fa-list"></i> Recommended Crops</h2>
						<div class="recommendations-content">
							<p>Enter your details to see crop recommendations here.</p>
						</div>
						<div id="cropDetails" style="margin-top:20px;"></div>
					</div>
				</div>
			</div>
		</main>
	</div>

	<script>
		document.addEventListener('DOMContentLoaded', function() {
			const cropForm = document.getElementById('cropForm');
			const recommendationsContent = document.querySelector('.recommendations-content');
			const cropDetails = document.getElementById('cropDetails');
			let allCrops = [];

			cropForm.addEventListener('submit', function(e) {
				e.preventDefault();
				const soilType = document.getElementById('soilType').value;
				const temperature = document.getElementById('temperature').value;
				const rainfall = document.getElementById('rainfall').value;

				recommendationsContent.innerHTML = '<p>Loading recommendations...</p>';
				cropDetails.innerHTML = '';

				fetch(`http://localhost:5000/api/crops?soilType=${soilType}&temperature=${temperature}&rainfall=${rainfall}`)
					.then(res => {
						if (!res.ok) {
							throw new Error('Network response was not ok');
						}
						return res.json();
					})
					.then(data => {
						allCrops = data;
						renderRecommendations(data);
					})
					.catch(error => {
						console.error('Error:', error);
						recommendationsContent.innerHTML = `
							<p style="color: #d32f2f;">
								Error: Could not connect to server. 
								<br><small>Make sure your backend is running on port 5000</small>
							</p>
						`;
						cropDetails.innerHTML = '';
					});
			});

			function renderRecommendations(data) {
				if (data.length === 0) {
					recommendationsContent.innerHTML = '<p>No recommendations found for these conditions.</p>';
					cropDetails.innerHTML = '';
				} else {
					recommendationsContent.innerHTML = `
						<ul style="list-style: none; padding: 0;">
							${data.map(c => `<li style="padding: 8px; background: #f0f7f0; margin: 5px 0; border-radius: 5px;">ðŸŒ± ${c.recommended_crop}</li>`).join('')}
						</ul>
					`;
					cropDetails.innerHTML = data.map(c => `
						<div style="background: #e8f5e9; padding: 15px; margin: 10px 0; border-radius: 8px; border-left: 4px solid #4caf50;">
							<strong style="color: #2e7d32;">${c.recommended_crop}:</strong> 
							<span style="color: #333;">${c.crop_details}</span>
						</div>
					`).join('');
				}
			}
		});
	</script>
</body>
</html>